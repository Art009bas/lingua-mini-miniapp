<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–∫–ª—è—Ç—ã–µ —Ä—É–∏–Ω—ã: –ë–∏—Ç–≤–∞ –∑–∞ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=MedievalSharp&display=swap');
        
        :root {
            --primary-dark: #1a2a32;
            --primary-gold: #d4af37;
            --primary-emerald: #50c878;
            --secondary-dark: #0d1b2a;
            --secondary-gold: #f9d423;
        }
        
        body {
            font-family: 'MedievalSharp', cursive;
            background-color: var(--primary-dark);
            color: white;
            touch-action: manipulation;
            user-select: none;
            padding-top: 180px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —à–∞–ø–∫–∏ */
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: var(--secondary-dark);
            z-index: 50;
            padding: 10px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .game-cell {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            background-color: var(--secondary-dark);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            transition: all 0.3s ease;
        }
        
        .game-cell.active {
            box-shadow: 0 0 15px var(--primary-gold);
        }
        
        .game-cell.special {
            background: radial-gradient(circle, var(--primary-emerald) 0%, var(--secondary-dark) 70%);
        }
        
        .player {
            width: 70%;
            height: 70%;
            border-radius: 50%;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            transition: all 0.5s ease;
            z-index: 10;
            font-size: 24px;
        }
        
        .player-human {
            background-color: var(--primary-gold);
            box-shadow: 0 0 10px var(--primary-gold);
        }
        
        .player-ai {
            background-color: var(--primary-emerald);
            box-shadow: 0 0 10px var(--primary-emerald);
        }
        
        .dice {
            width: 60px;
            height: 60px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s ease;
            margin: 0 auto;
        }
        
        .dice-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            background: white;
            border: 2px solid var(--primary-gold);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-dark);
        }
        
        .dice-face:nth-child(1) { transform: rotateY(0deg) translateZ(30px); }
        .dice-face:nth-child(2) { transform: rotateY(90deg) translateZ(30px); }
        .dice-face:nth-child(3) { transform: rotateX(90deg) translateZ(30px); }
        .dice-face:nth-child(4) { transform: rotateX(-90deg) translateZ(30px); }
        .dice-face:nth-child(5) { transform: rotateY(-90deg) translateZ(30px); }
        .dice-face:nth-child(6) { transform: rotateY(180deg) translateZ(30px); }
        
        @keyframes shake {
            0% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            50% { transform: translateX(5px) rotate(5deg); }
            75% { transform: translateX(-5px) rotate(-5deg); }
            100% { transform: translateX(0) rotate(0deg); }
        }
        
        .shake {
            animation: shake 0.5s ease infinite;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .modal.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .modal-content {
            background-color: var(--secondary-dark);
            border: 3px solid var(--primary-gold);
            border-radius: 15px;
            padding: 20px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        
        .modal.active .modal-content {
            transform: scale(1);
        }
        
        .event-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }
        
        .btn {
            background-color: var(--primary-gold);
            color: var(--primary-dark);
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            font-family: 'MedievalSharp', cursive;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 0 rgba(0,0,0,0.2);
        }
        
        .btn:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background-color: var(--primary-emerald);
        }
        
        .btn-disabled {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .progress-bar {
            height: 10px;
            background-color: var(--secondary-dark);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--primary-gold);
            transition: width 0.3s ease;
        }
        
        .log-entry {
            padding: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 14px;
        }
        
        .log-entry:last-child {
            border-bottom: none;
        }
        
        .log-human {
            color: var(--primary-gold);
        }
        
        .log-ai {
            color: var(--primary-emerald);
        }
        
        .log-event {
            color: white;
        }
        
        @media (max-width: 640px) {
            body {
                padding-top: 220px; /* –ë–æ–ª—å—à–∏–π –æ—Ç—Å—Ç—É–ø –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
            }
            
            .dice {
                width: 40px;
                height: 40px;
            }
            
            .dice-face {
                font-size: 18px;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 16px;
            }
            
            .player {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∞–ø–∫–∞ —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º -->
    <div class="header">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center mb-2">
                <h2 id="gameStatus" class="text-xl font-bold text-yellow-300">–¢–≤–æ–π —Ö–æ–¥</h2>
                <div class="flex items-center space-x-2">
                    <div class="bg-gray-800 px-3 py-1 rounded-full">
                        <span id="turnCounter">–•–æ–¥: 1</span>
                    </div>
                </div>
            </div>
            
            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="bg-gray-800 rounded-lg p-4">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="flex items-center space-x-4">
                        <div class="text-center">
                            <div class="dice" id="dice1">
                                <div class="dice-face">1</div>
                                <div class="dice-face">2</div>
                                <div class="dice-face">3</div>
                                <div class="dice-face">4</div>
                                <div class="dice-face">5</div>
                                <div class="dice-face">6</div>
                            </div>
                            <span class="text-sm mt-1 block">–ö—É–±–∏–∫ 1</span>
                        </div>
                        <div class="text-center">
                            <div class="dice" id="dice2">
                                <div class="dice-face">1</div>
                                <div class="dice-face">2</div>
                                <div class="dice-face">3</div>
                                <div class="dice-face">4</div>
                                <div class="dice-face">5</div>
                                <div class="dice-face">6</div>
                            </div>
                            <span class="text-sm mt-1 block">–ö—É–±–∏–∫ 2</span>
                        </div>
                    </div>
                    
                    <div class="flex flex-col space-y-2 w-full md:w-auto">
                        <button id="rollDiceBtn" class="btn">–ë—Ä–æ—Å–∏—Ç—å –∫—É–±–∏–∫–∏</button>
                        <button id="specialAbilityBtn" class="btn btn-secondary opacity-50 pointer-events-none">–ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫–∞</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ò–Ω—Ç—Ä–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="introModal" class="modal active">
        <div class="modal-content text-center p-6 max-w-md">
            <h1 class="text-3xl font-bold mb-4 text-yellow-300">–ü—Ä–æ–∫–ª—è—Ç—ã–µ —Ä—É–∏–Ω—ã: –ë–∏—Ç–≤–∞ –∑–∞ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç</h1>
            <div class="mb-6">
                <p class="mb-3">–¢—ã ‚Äî –æ—Ç–≤–∞–∂–Ω—ã–π –∏—Å–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π, –ø—Ä–æ–Ω–∏–∫—à–∏–π –≤ –¥—Ä–µ–≤–Ω–∏–µ –ø—Ä–æ–∫–ª—è—Ç—ã–µ —Ä—É–∏–Ω—ã, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –ê—Ä—Ç–µ—Ñ–∞–∫—Ç –í–µ—á–Ω–æ—Å—Ç–∏.</p>
                <p class="mb-3">–ü–æ —Å–ª—É—Ö–∞–º, —Ç–æ—Ç, –∫—Ç–æ –ø–µ—Ä–≤—ã–º –¥–æ–±–µ—Ä—ë—Ç—Å—è –¥–æ –Ω–µ–≥–æ, –ø–æ–ª—É—á–∏—Ç –≤–ª–∞—Å—Ç—å —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–µ–º.</p>
                <p class="mb-3">–ù–æ —Ç—ã –Ω–µ –æ–¥–∏–Ω. –ó–∞ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º –æ—Ö–æ—Ç–∏—Ç—Å—è —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–æ–ø–µ—Ä–Ω–∏–∫ ‚Äî –ò–ò-–∞—Ä—Ö–µ–æ–ª–æ–≥ –ê—Ä—Ö–∞–ô–û–ù, —Ü–∏—Ñ—Ä–æ–≤–æ–π —Ä–∞–∑—É–º, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∞–º–∏–º –•—Ä–∞–º–æ–º.</p>
            </div>
            <div class="mb-6 text-left">
                <h2 class="text-xl font-bold mb-2 text-yellow-300">–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</h2>
                <ul class="list-disc pl-5 space-y-1">
                    <li>–ë—Ä–æ—Å–∞–π –∫—É–±–∏–∫ –¥–≤–∞–∂–¥—ã –∑–∞ —Ö–æ–¥</li>
                    <li>–ü—Ä–æ–¥–≤–∏–≥–∞–π—Å—è –ø–æ –ø–æ–ª—é –Ω–∞ —Å—É–º–º—É –æ—á–∫–æ–≤</li>
                    <li>–í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è –∏ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞–π –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è</li>
                    <li>–ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç–∏–≥—à–∏–π –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–ª–µ—Ç–∫–∏ –ø–æ–±–µ–∂–¥–∞–µ—Ç!</li>
                </ul>
            </div>
            <div class="flex flex-col space-y-3">
                <input type="text" id="playerName" placeholder="–í–≤–µ–¥–∏ —Å–≤–æ—ë –∏–º—è" class="px-4 py-2 rounded bg-gray-800 border border-yellow-300 text-white text-center" value="–†–µ–π–¥–µ—Ä">
                <button id="startGameBtn" class="btn">–ù–∞—á–∞—Ç—å —ç–∫—Å–ø–µ–¥–∏—Ü–∏—é</button>
            </div>
        </div>
    </div>
    
    <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
    <div class="container mx-auto px-4 py-6">
        <div class="flex flex-col lg:flex-row gap-6">
            <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
            <div class="flex-grow">
                <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
                <div id="gameBoard" class="grid grid-cols-10 gap-2 mb-6">
                    <!-- –ö–ª–µ—Ç–∫–∏ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
            <div class="w-full lg:w-64 bg-gray-800 rounded-lg p-4 flex flex-col">
                <h3 class="text-lg font-bold mb-3 text-yellow-300">–ñ—É—Ä–Ω–∞–ª —ç–∫—Å–ø–µ–¥–∏—Ü–∏–∏</h3>
                <div id="gameLog" class="flex-grow overflow-y-auto mb-4 max-h-64">
                    <!-- –ó–∞–ø–∏—Å–∏ –∂—É—Ä–Ω–∞–ª–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
                
                <div class="mt-auto">
                    <div class="mb-4">
                        <h4 class="font-bold mb-1">–†–µ–π–¥–µ—Ä</h4>
                        <div class="progress-bar">
                            <div id="playerProgress" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <h4 class="font-bold mb-1">–ê—Ä—Ö–∞–ô–û–ù</h4>
                        <div class="progress-bar">
                            <div id="aiProgress" class="progress-fill bg-emerald-500" style="width: 0%"></div>
                        </div>
                    </div>
                    <button id="restartGameBtn" class="btn w-full">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–±—ã—Ç–∏—è -->
    <div id="eventModal" class="modal">
        <div class="modal-content text-center p-6 max-w-md">
            <div id="eventIcon" class="event-icon">‚ö°</div>
            <h2 id="eventTitle" class="text-2xl font-bold mb-3 text-yellow-300">–°–æ–±—ã—Ç–∏–µ</h2>
            <p id="eventDescription" class="mb-6">–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è</p>
            <div id="eventOptions" class="flex flex-col space-y-3">
                <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã -->
    <div id="endGameModal" class="modal">
        <div class="modal-content text-center p-6 max-w-md">
            <h2 id="endGameTitle" class="text-3xl font-bold mb-4 text-yellow-300">–ü–æ–±–µ–¥–∞!</h2>
            <p id="endGameMessage" class="mb-6">–¢—ã –æ–≤–ª–∞–¥–µ–ª –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º! –í—Ä–µ–º—è ‚Äî –≤ —Ç–≤–æ–∏—Ö —Ä—É–∫–∞—Ö‚Ä¶</p>
            <button id="playAgainBtn" class="btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>
    
    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏–≥—Ä—ã
        const BOARD_COLS = 10;
        const BOARD_ROWS = 20;
        const TOTAL_CELLS = BOARD_COLS * BOARD_ROWS;
        
        // –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π –Ω–∞ –∫–ª–µ—Ç–∫–∞—Ö
        const EVENT_TYPES = {
            NORMAL: 0,
            QUESTION: 1,
            OBSTACLE: 2,
            BONUS: 3,
            TRAP: 4,
            PUZZLE: 5,
            RIDDLE: 6,
            SWAP: 7,
            EXTRA_TURN: 8
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            playerPosition: 0,
            aiPosition: 0,
            currentPlayer: 'human',
            turn: 1,
            dice1Value: 1,
            dice2Value: 1,
            diceRolled: false,
            specialAbilityUsed: false,
            gameStarted: false,
            playerName: '–†–µ–π–¥–µ—Ä',
            events: [],
            waitingForEvent: false // –§–ª–∞–≥ –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è
        };
        
        // –í–æ–ø—Ä–æ—Å—ã –∏ –∑–∞–¥–∞–Ω–∏—è
        const QUESTIONS = [
            {
                question: "–ö–∞–∫–æ–π —Å–∏–º–≤–æ–ª –æ–∑–Ω–∞—á–∞–µ—Ç '–≤–µ—á–Ω–æ—Å—Ç—å' –≤ –¥—Ä–µ–≤–Ω–µ–º —è–∑—ã–∫–µ —Ä—É–∏–Ω?",
                options: ["‚àû", "Œî", "Œ®", "Œò"],
                answer: 0
            },
            {
                question: "–ö–∞–∫–æ–µ –∏–∑ —ç—Ç–∏—Ö —Å—É—â–µ—Å—Ç–≤ –æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä—É–∏–Ω—ã?",
                options: ["–ö–∞–º–µ–Ω–Ω—ã–π –≥–æ–ª–µ–º", "–û–≥–Ω–µ–Ω–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", "–ü—Ä–∏–∑—Ä–∞–∫ –ø—Ä–æ—à–ª–æ–≥–æ", "–í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã"],
                answer: 3
            },
            {
                question: "–ö–∞–∫–æ–π —ç–ª–µ–º–µ–Ω—Ç –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –¥–≤–µ—Ä–∏?",
                options: ["–í–æ–¥–∞", "–û–≥–æ–Ω—å", "–ó–µ–º–ª—è", "–í–æ–∑–¥—É—Ö"],
                answer: 1
            }
        ];
        
        const RIDDLES = [
            {
                riddle: "–Ø –±–µ—Å–∫–æ–Ω–µ—á–µ–Ω –≤ –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ. –ß—Ç–æ —è?",
                answer: "–±—É–∫–≤–∞ –ï"
            },
            {
                riddle: "–ß–µ–º –±–æ–ª—å—à–µ –±–µ—Ä—ë—à—å, —Ç–µ–º –±–æ–ª—å—à–µ –æ—Å—Ç–∞–≤–ª—è–µ—à—å. –ß—Ç–æ —ç—Ç–æ?",
                answer: "—à–∞–≥–∏"
            }
        ];
        
        const SYMBOLS = ["‚àû", "Œî", "Œ®", "Œò", "Œ£", "Œ©", "Œ¶", "Œõ"];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            generateBoard();
            updateUI();
            addLogEntry("–≠–∫—Å–ø–µ–¥–∏—Ü–∏—è –Ω–∞—á–∞–ª–∞—Å—å! –ö—Ç–æ –ø–µ—Ä–≤—ã–º –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∞?", 'event');
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π –Ω–∞ –ø–æ–ª–µ
            generateEvents();
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
        function generateBoard() {
            const gameBoard = document.getElementById('gameBoard');
            gameBoard.innerHTML = '';
            
            for (let row = 0; row < BOARD_ROWS; row++) {
                for (let col = 0; col < BOARD_COLS; col++) {
                    const cellIndex = row * BOARD_COLS + col;
                    const cell = document.createElement('div');
                    cell.className = 'game-cell';
                    cell.dataset.index = cellIndex;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä –∫–ª–µ—Ç–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
                    const cellNumber = document.createElement('span');
                    cellNumber.className = 'absolute top-1 left-1 text-xs text-gray-500';
                    cellNumber.textContent = cellIndex + 1;
                    cell.appendChild(cellNumber);
                    
                    gameBoard.appendChild(cell);
                }
            }
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –Ω–∞ –ø–æ–ª–µ
        function generateEvents() {
            gameState.events = Array(TOTAL_CELLS).fill(EVENT_TYPES.NORMAL);
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–ª–µ—Ç–∫–∏
            const specialCells = [
                {index: 5, type: EVENT_TYPES.QUESTION},
                {index: 12, type: EVENT_TYPES.OBSTACLE},
                {index: 18, type: EVENT_TYPES.BONUS},
                {index: 25, type: EVENT_TYPES.TRAP},
                {index: 33, type: EVENT_TYPES.PUZZLE},
                {index: 42, type: EVENT_TYPES.RIDDLE},
                {index: 50, type: EVENT_TYPES.SWAP},
                {index: 58, type: EVENT_TYPES.EXTRA_TURN},
                {index: 65, type: EVENT_TYPES.QUESTION},
                {index: 72, type: EVENT_TYPES.OBSTACLE},
                {index: 80, type: EVENT_TYPES.BONUS},
                {index: 88, type: EVENT_TYPES.TRAP},
                {index: 95, type: EVENT_TYPES.PUZZLE},
                {index: 105, type: EVENT_TYPES.RIDDLE},
                {index: 115, type: EVENT_TYPES.SWAP},
                {index: 125, type: EVENT_TYPES.EXTRA_TURN},
                {index: 135, type: EVENT_TYPES.QUESTION},
                {index: 145, type: EVENT_TYPES.OBSTACLE},
                {index: 155, type: EVENT_TYPES.BONUS},
                {index: 165, type: EVENT_TYPES.TRAP},
                {index: 175, type: EVENT_TYPES.PUZZLE},
                {index: 185, type: EVENT_TYPES.RIDDLE},
                {index: 195, type: EVENT_TYPES.SWAP}
            ];
            
            specialCells.forEach(cell => {
                if (cell.index < TOTAL_CELLS) {
                    gameState.events[cell.index] = cell.type;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä –Ω–∞ –∫–ª–µ—Ç–∫—É
                    const cellElement = document.querySelector(`.game-cell[data-index="${cell.index}"]`);
                    if (cellElement) {
                        cellElement.classList.add('special');
                        
                        const eventMarker = document.createElement('div');
                        eventMarker.className = 'absolute bottom-1 right-1 text-lg';
                        
                        switch (cell.type) {
                            case EVENT_TYPES.QUESTION:
                                eventMarker.textContent = '?';
                                break;
                            case EVENT_TYPES.OBSTACLE:
                                eventMarker.textContent = '‚ö†';
                                break;
                            case EVENT_TYPES.BONUS:
                                eventMarker.textContent = '‚Üë';
                                break;
                            case EVENT_TYPES.TRAP:
                                eventMarker.textContent = '‚Üì';
                                break;
                            case EVENT_TYPES.PUZZLE:
                                eventMarker.textContent = '‚åó';
                                break;
                            case EVENT_TYPES.RIDDLE:
                                eventMarker.textContent = '‚ùì';
                                break;
                            case EVENT_TYPES.SWAP:
                                eventMarker.textContent = '‚áÑ';
                                break;
                            case EVENT_TYPES.EXTRA_TURN:
                                eventMarker.textContent = '‚Üª';
                                break;
                        }
                        
                        cellElement.appendChild(eventMarker);
                    }
                }
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏–∏ –∏–≥—Ä–æ–∫–æ–≤
            updatePlayerPositions();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∏–≥—Ä—ã
            document.getElementById('turnCounter').textContent = `–•–æ–¥: ${gameState.turn}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            document.getElementById('playerProgress').style.width = `${(gameState.playerPosition / (TOTAL_CELLS - 1)) * 100}%`;
            document.getElementById('aiProgress').style.width = `${(gameState.aiPosition / (TOTAL_CELLS - 1)) * 100}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            const rollDiceBtn = document.getElementById('rollDiceBtn');
            const specialAbilityBtn = document.getElementById('specialAbilityBtn');
            
            if (gameState.currentPlayer === 'human' && !gameState.diceRolled && !gameState.waitingForEvent) {
                rollDiceBtn.classList.remove('btn-disabled');
                document.getElementById('gameStatus').textContent = `${gameState.playerName}, —Ç–≤–æ–π —Ö–æ–¥`;
            } else if (gameState.currentPlayer === 'human' && gameState.diceRolled) {
                rollDiceBtn.classList.add('btn-disabled');
                document.getElementById('gameStatus').textContent = `${gameState.playerName}, –≤—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞–Ω–∏–µ`;
            } else {
                rollDiceBtn.classList.add('btn-disabled');
                document.getElementById('gameStatus').textContent = `–•–æ–¥ –ê—Ä—Ö–∞–ô–û–ù–∞`;
            }
            
            if (!gameState.specialAbilityUsed && gameState.diceRolled && gameState.currentPlayer === 'human') {
                specialAbilityBtn.classList.remove('opacity-50', 'pointer-events-none');
            } else {
                specialAbilityBtn.classList.add('opacity-50', 'pointer-events-none');
            }
            
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–ª–µ—Ç–∫—É
            document.querySelectorAll('.game-cell').forEach(cell => {
                cell.classList.remove('active');
            });
            
            const activePlayer = gameState.currentPlayer === 'human' ? gameState.playerPosition : gameState.aiPosition;
            const activeCell = document.querySelector(`.game-cell[data-index="${activePlayer}"]`);
            if (activeCell) {
                activeCell.classList.add('active');
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ –ø–æ–ª–µ
        function updatePlayerPositions() {
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏
            document.querySelectorAll('.player').forEach(player => player.remove());
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞
            const playerCell = document.querySelector(`.game-cell[data-index="${gameState.playerPosition}"]`);
            if (playerCell) {
                const playerElement = document.createElement('div');
                playerElement.className = 'player player-human';
                playerElement.textContent = 'üß≠'; // –≠–º–æ–¥–∑–∏ –∫–æ–º–ø–∞—Å–∞ –¥–ª—è –∏–≥—Ä–æ–∫–∞
                playerCell.appendChild(playerElement);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ò–ò
            const aiCell = document.querySelector(`.game-cell[data-index="${gameState.aiPosition}"]`);
            if (aiCell) {
                const aiElement = document.createElement('div');
                aiElement.className = 'player player-ai';
                aiElement.textContent = 'üëÅ'; // –≠–º–æ–¥–∑–∏ –≥–ª–∞–∑–∞ –¥–ª—è –ò–ò
                aiCell.appendChild(aiElement);
            }
        }
        
        // –ë—Ä–æ—Å–æ–∫ –∫—É–±–∏–∫–æ–≤
        function rollDice() {
            if (gameState.diceRolled || gameState.waitingForEvent) return;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫—É–±–∏–∫–æ–≤
            const dice1 = document.getElementById('dice1');
            const dice2 = document.getElementById('dice2');
            
            dice1.classList.add('shake');
            dice2.classList.add('shake');
            
            setTimeout(() => {
                // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                gameState.dice1Value = Math.floor(Math.random() * 6) + 1;
                gameState.dice2Value = Math.floor(Math.random() * 6) + 1;
                
                // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –∫—É–±–∏–∫–æ–≤
                setDiceFace(dice1, gameState.dice1Value);
                setDiceFace(dice2, gameState.dice2Value);
                
                dice1.classList.remove('shake');
                dice2.classList.remove('shake');
                
                gameState.diceRolled = true;
                
                // –ó–∞–ø–∏—Å—å –≤ –∂—É—Ä–Ω–∞–ª
                addLogEntry(`${gameState.playerName} –±—Ä–æ—Å–∞–µ—Ç –∫—É–±–∏–∫–∏: ${gameState.dice1Value} –∏ ${gameState.dice2Value}`, 'human');
                
                // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
                movePlayer();
                
                updateUI();
            }, 1000);
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –∫—É–±–∏–∫–∞
        function setDiceFace(diceElement, value) {
            const rotation = {
                1: 'rotateX(0deg) rotateY(0deg)',
                2: 'rotateX(0deg) rotateY(-90deg)',
                3: 'rotateX(-90deg) rotateY(0deg)',
                4: 'rotateX(90deg) rotateY(0deg)',
                5: 'rotateX(0deg) rotateY(90deg)',
                6: 'rotateX(0deg) rotateY(180deg)'
            };
            
            diceElement.style.transform = rotation[value];
        }
        
        // –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞
        function movePlayer() {
            const totalSteps = gameState.dice1Value + gameState.dice2Value;
            let newPosition;
            
            if (gameState.currentPlayer === 'human') {
                newPosition = gameState.playerPosition + totalSteps;
                if (newPosition >= TOTAL_CELLS) {
                    newPosition = TOTAL_CELLS - 1;
                }
                gameState.playerPosition = newPosition;
                
                addLogEntry(`${gameState.playerName} –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ ${totalSteps} –∫–ª–µ—Ç–æ–∫`, 'human');
            } else {
                newPosition = gameState.aiPosition + totalSteps;
                if (newPosition >= TOTAL_CELLS) {
                    newPosition = TOTAL_CELLS - 1;
                }
                gameState.aiPosition = newPosition;
                
                addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ ${totalSteps} –∫–ª–µ—Ç–æ–∫`, 'ai');
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–±–µ–¥—É
            if (!checkWinCondition()) {
                // –ï—Å–ª–∏ –∏–≥—Ä–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –∫–ª–µ—Ç–∫–µ
                checkCellEvent();
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–±—ã—Ç–∏—è –Ω–∞ –∫–ª–µ—Ç–∫–µ
        function checkCellEvent() {
            const position = gameState.currentPlayer === 'human' ? gameState.playerPosition : gameState.aiPosition;
            const eventType = gameState.events[position];
            
            gameState.waitingForEvent = true;
            
            switch (eventType) {
                case EVENT_TYPES.NORMAL:
                    if (gameState.currentPlayer === 'human') {
                        setTimeout(() => {
                            gameState.waitingForEvent = false;
                            endTurn();
                        }, 1000);
                    } else {
                        setTimeout(() => {
                            gameState.waitingForEvent = false;
                            endTurn();
                        }, 1500);
                    }
                    break;
                    
                case EVENT_TYPES.QUESTION:
                    showQuestionEvent();
                    break;
                    
                case EVENT_TYPES.OBSTACLE:
                    showObstacleEvent();
                    break;
                    
                case EVENT_TYPES.BONUS:
                    showBonusEvent();
                    break;
                    
                case EVENT_TYPES.TRAP:
                    showTrapEvent();
                    break;
                    
                case EVENT_TYPES.PUZZLE:
                    showPuzzleEvent();
                    break;
                    
                case EVENT_TYPES.RIDDLE:
                    showRiddleEvent();
                    break;
                    
                case EVENT_TYPES.SWAP:
                    showSwapEvent();
                    break;
                    
                case EVENT_TYPES.EXTRA_TURN:
                    showExtraTurnEvent();
                    break;
                    
                default:
                    gameState.waitingForEvent = false;
                    endTurn();
                    break;
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–≤–æ–ø—Ä–æ—Å
        function showQuestionEvent() {
            const question = QUESTIONS[Math.floor(Math.random() * QUESTIONS.length)];
            
            document.getElementById('eventIcon').textContent = '‚ùì';
            document.getElementById('eventTitle').textContent = '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª';
            document.getElementById('eventDescription').textContent = question.question;
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.textContent = option;
                btn.addEventListener('click', () => {
                    handleQuestionAnswer(index === question.answer);
                });
                optionsContainer.appendChild(btn);
            });
            
            showEventModal();
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å
        function handleQuestionAnswer(isCorrect) {
            hideEventModal();
            
            if (gameState.currentPlayer === 'human') {
                if (isCorrect) {
                    addLogEntry(`${gameState.playerName} –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ –≤–æ–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∞–µ—Ç –±–æ–Ω—É—Å!`, 'event');
                    // –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                    gameState.playerPosition = Math.min(gameState.playerPosition + 2, TOTAL_CELLS - 1);
                    updatePlayerPositions();
                } else {
                    addLogEntry(`${gameState.playerName} –æ—à–∏–±—Å—è –≤ –æ—Ç–≤–µ—Ç–µ –∏ —Ç–µ—Ä—è–µ—Ç —Ö–æ–¥!`, 'event');
                }
            } else {
                // –ò–ò –∏–º–µ–µ—Ç 50% —à–∞–Ω—Å –æ—à–∏–±–∏—Ç—å—Å—è
                const aiCorrect = Math.random() > 0.5;
                
                if (aiCorrect) {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–ª —Å–∏–º–≤–æ–ª –∏ –ø–æ–ª—É—á–∞–µ—Ç –±–æ–Ω—É—Å!`, 'event');
                    gameState.aiPosition = Math.min(gameState.aiPosition + 2, TOTAL_CELLS - 1);
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –æ—à–∏–±—Å—è –≤ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–µ —Å–∏–º–≤–æ–ª–∞!`, 'event');
                }
                
                updatePlayerPositions();
            }
            
            setTimeout(() => {
                gameState.waitingForEvent = false;
                if (!checkWinCondition()) {
                    endTurn();
                }
            }, 1000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ
        function showObstacleEvent() {
            document.getElementById('eventIcon').textContent = '‚ö†';
            document.getElementById('eventTitle').textContent = '–ü—Ä–æ–∫–ª—è—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–∏';
            document.getElementById('eventDescription').textContent = '–¢—ã –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –¥—Ä–µ–≤–Ω–µ–µ –ø—Ä–æ–∫–ª—è—Ç–∏–µ! –¢–µ–±—è –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç –Ω–∞–∑–∞–¥.';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            btn.addEventListener('click', () => {
                hideEventModal();
                
                if (gameState.currentPlayer === 'human') {
                    addLogEntry(`${gameState.playerName} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –ø—Ä–æ–∫–ª—è—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–∏!`, 'event');
                    gameState.playerPosition = Math.max(0, gameState.playerPosition - 3);
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª –ø—Ä–æ–∫–ª—è—Ç–∏–µ –≤—Ä–µ–º–µ–Ω–∏!`, 'event');
                    gameState.aiPosition = Math.max(0, gameState.aiPosition - 3);
                }
                
                updatePlayerPositions();
                
                setTimeout(() => {
                    gameState.waitingForEvent = false;
                    if (!checkWinCondition()) {
                        endTurn();
                    }
                }, 1000);
            });
            
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–±–æ–Ω—É—Å
        function showBonusEvent() {
            document.getElementById('eventIcon').textContent = '‚Üë';
            document.getElementById('eventTitle').textContent = '–ë–æ–Ω—É—Å —Ñ–∞–∫–µ–ª–∞';
            document.getElementById('eventDescription').textContent = '–¢—ã –Ω–∞—à—ë–ª —Å–∫—Ä—ã—Ç—ã–π —Ö–æ–¥! –ü—Ä–æ–¥–≤–∏–≥–∞–µ—à—å—Å—è –≤–ø–µ—Ä—ë–¥.';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            btn.addEventListener('click', () => {
                hideEventModal();
                
                if (gameState.currentPlayer === 'human') {
                    addLogEntry(`${gameState.playerName} –Ω–∞—à—ë–ª —Å–∫—Ä—ã—Ç—ã–π —Ö–æ–¥!`, 'event');
                    gameState.playerPosition = Math.min(TOTAL_CELLS - 1, gameState.playerPosition + 2);
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –Ω–∞—à—ë–ª —Å–∫—Ä—ã—Ç—ã–π —Ö–æ–¥!`, 'event');
                    gameState.aiPosition = Math.min(TOTAL_CELLS - 1, gameState.aiPosition + 2);
                }
                
                updatePlayerPositions();
                
                setTimeout(() => {
                    gameState.waitingForEvent = false;
                    if (!checkWinCondition()) {
                        endTurn();
                    }
                }, 1000);
            });
            
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–ª–æ–≤—É—à–∫—É
        function showTrapEvent() {
            document.getElementById('eventIcon').textContent = '‚Üì';
            document.getElementById('eventTitle').textContent = '–ü—Ä–∏–∑—Ä–∞–∫ –ø—Ä–æ—à–ª–æ–≥–æ';
            document.getElementById('eventDescription').textContent = '–ü—Ä–∏–∑—Ä–∞–∫ –ø—Ä–æ—à–ª–æ–≥–æ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç —Ç–µ–±—è! –¢—ã –ø—Ä–æ–ø—É—Å–∫–∞–µ—à—å —Ö–æ–¥.';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            btn.addEventListener('click', () => {
                hideEventModal();
                
                if (gameState.currentPlayer === 'human') {
                    addLogEntry(`${gameState.playerName} –≤—Å—Ç—Ä–µ—Ç–∏–ª –ø—Ä–∏–∑—Ä–∞–∫–∞ –ø—Ä–æ—à–ª–æ–≥–æ –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ö–æ–¥!`, 'event');
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –≤—Å—Ç—Ä–µ—Ç–∏–ª –ø—Ä–∏–∑—Ä–∞–∫–∞ –ø—Ä–æ—à–ª–æ–≥–æ –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ö–æ–¥!`, 'event');
                }
                
                setTimeout(() => {
                    gameState.waitingForEvent = false;
                    if (!checkWinCondition()) {
                        endTurn();
                    }
                }, 1000);
            });
            
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–≥–æ–ª–æ–≤–æ–ª–æ–º–∫—É
        function showPuzzleEvent() {
            const correctSymbol = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
            const options = [correctSymbol];
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
            while (options.length < 4) {
                const randomSymbol = SYMBOLS[Math.floor(Math.random() * SYMBOLS.length)];
                if (!options.includes(randomSymbol)) {
                    options.push(randomSymbol);
                }
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
            options.sort(() => Math.random() - 0.5);
            
            document.getElementById('eventIcon').textContent = '‚åó';
            document.getElementById('eventTitle').textContent = '–î—Ä–µ–≤–Ω–∏–π –∫–æ–¥';
            document.getElementById('eventDescription').textContent = '–í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å:';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach((symbol, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.textContent = symbol;
                btn.addEventListener('click', () => {
                    handlePuzzleAnswer(symbol === correctSymbol);
                });
                optionsContainer.appendChild(btn);
            });
            
            showEventModal();
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≥–æ–ª–æ–≤–æ–ª–æ–º–∫—É
        function handlePuzzleAnswer(isCorrect) {
            hideEventModal();
            
            if (gameState.currentPlayer === 'human') {
                if (isCorrect) {
                    addLogEntry(`${gameState.playerName} –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±—Ä–∞–ª —Å–∏–º–≤–æ–ª –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ!`, 'event');
                } else {
                    addLogEntry(`${gameState.playerName} –æ—à–∏–±—Å—è –≤ –≤—ã–±–æ—Ä–µ —Å–∏–º–≤–æ–ª–∞ –∏ —Ç–µ—Ä—è–µ—Ç —Ö–æ–¥!`, 'event');
                }
            } else {
                // –ò–ò –∏–º–µ–µ—Ç 60% —à–∞–Ω—Å –æ—à–∏–±–∏—Ç—å—Å—è
                const aiCorrect = Math.random() > 0.4;
                
                if (aiCorrect) {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±—Ä–∞–ª —Å–∏–º–≤–æ–ª –∏ –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–∞–ª—å—à–µ!`, 'event');
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –æ—à–∏–±—Å—è –≤ –≤—ã–±–æ—Ä–µ —Å–∏–º–≤–æ–ª–∞!`, 'event');
                }
            }
            
            setTimeout(() => {
                gameState.waitingForEvent = false;
                if (!checkWinCondition()) {
                    endTurn();
                }
            }, 1000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–∑–∞–≥–∞–¥–∫—É
        function showRiddleEvent() {
            const riddle = RIDDLES[Math.floor(Math.random() * RIDDLES.length)];
            
            document.getElementById('eventIcon').textContent = '‚ùì';
            document.getElementById('eventTitle').textContent = '–ë–∏—Ç–≤–∞ —Ä–∞–∑—É–º–∞';
            document.getElementById('eventDescription').textContent = riddle.riddle;
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = '–¢–≤–æ–π –æ—Ç–≤–µ—Ç...';
            input.className = 'px-4 py-2 rounded bg-gray-800 border border-yellow-300 text-white w-full mb-3';
            optionsContainer.appendChild(input);
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–û—Ç–≤–µ—Ç–∏—Ç—å';
            btn.addEventListener('click', () => {
                const answer = input.value.trim().toLowerCase();
                handleRiddleAnswer(answer === riddle.answer.toLowerCase());
            });
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞–≥–∞–¥–∫—É
        function handleRiddleAnswer(isCorrect) {
            hideEventModal();
            
            if (gameState.currentPlayer === 'human') {
                if (isCorrect) {
                    addLogEntry(`${gameState.playerName} –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–≥–∞–¥–∞–ª –∑–∞–≥–∞–¥–∫—É –∏ –ø–æ–ª—É—á–∞–µ—Ç –±–æ–Ω—É—Å!`, 'event');
                    gameState.playerPosition = Math.min(gameState.playerPosition + 3, TOTAL_CELLS - 1);
                    updatePlayerPositions();
                } else {
                    addLogEntry(`${gameState.playerName} –Ω–µ —Å–º–æ–≥ —Ä–∞–∑–≥–∞–¥–∞—Ç—å –∑–∞–≥–∞–¥–∫—É!`, 'event');
                }
            } else {
                // –ò–ò –∏–º–µ–µ—Ç 70% —à–∞–Ω—Å –æ—à–∏–±–∏—Ç—å—Å—è
                const aiCorrect = Math.random() > 0.3;
                
                if (aiCorrect) {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–∑–≥–∞–¥–∞–ª –∑–∞–≥–∞–¥–∫—É –∏ –ø–æ–ª—É—á–∞–µ—Ç –±–æ–Ω—É—Å!`, 'event');
                    gameState.aiPosition = Math.min(gameState.aiPosition + 3, TOTAL_CELLS - 1);
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –Ω–µ —Å–º–æ–≥ —Ä–∞–∑–≥–∞–¥–∞—Ç—å –∑–∞–≥–∞–¥–∫—É!`, 'event');
                }
                
                updatePlayerPositions();
            }
            
            setTimeout(() => {
                gameState.waitingForEvent = false;
                if (!checkWinCondition()) {
                    endTurn();
                }
            }, 1000);
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–æ–±–º–µ–Ω
        function showSwapEvent() {
            document.getElementById('eventIcon').textContent = '‚áÑ';
            document.getElementById('eventTitle').textContent = '–ü–∞—É—Ç–∏–Ω–∞ –∏–ª–ª—é–∑–∏–π';
            document.getElementById('eventDescription').textContent = '–ò–ª–ª—é–∑–∏–∏ —Ä—É–∏–Ω –∑–∞–ø—É—Ç–∞–ª–∏ –≤–∞—Å! –í—ã –º–µ–Ω—è–µ—Ç–µ—Å—å –º–µ—Å—Ç–∞–º–∏ —Å —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–º.';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            btn.addEventListener('click', () => {
                hideEventModal();
                
                const temp = gameState.playerPosition;
                gameState.playerPosition = gameState.aiPosition;
                gameState.aiPosition = temp;
                
                addLogEntry(`–ü–∞—É—Ç–∏–Ω–∞ –∏–ª–ª—é–∑–∏–π –ø–æ–º–µ–Ω—è–ª–∞ –º–µ—Å—Ç–∞–º–∏ ${gameState.playerName} –∏ –ê—Ä—Ö–∞–ô–û–ù–∞!`, 'event');
                
                updatePlayerPositions();
                
                setTimeout(() => {
                    gameState.waitingForEvent = false;
                    if (!checkWinCondition()) {
                        endTurn();
                    }
                }, 1000);
            });
            
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ö–æ–¥
        function showExtraTurnEvent() {
            document.getElementById('eventIcon').textContent = '‚Üª';
            document.getElementById('eventTitle').textContent = '–°–æ—Å—É–¥ —É–¥–∞—á–∏';
            document.getElementById('eventDescription').textContent = '–¢—ã –Ω–∞—à—ë–ª —Å–æ—Å—É–¥ —É–¥–∞—á–∏! –ü–æ–ª—É—á–∞–µ—à—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ö–æ–¥.';
            
            const optionsContainer = document.getElementById('eventOptions');
            optionsContainer.innerHTML = '';
            
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = '–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å';
            btn.addEventListener('click', () => {
                hideEventModal();
                
                if (gameState.currentPlayer === 'human') {
                    addLogEntry(`${gameState.playerName} –Ω–∞—à—ë–ª —Å–æ—Å—É–¥ —É–¥–∞—á–∏ –∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ö–æ–¥!`, 'event');
                } else {
                    addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –Ω–∞—à—ë–ª —Å–æ—Å—É–¥ —É–¥–∞—á–∏ –∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ö–æ–¥!`, 'event');
                }
                
                setTimeout(() => {
                    gameState.diceRolled = false;
                    gameState.waitingForEvent = false;
                    updateUI();
                    
                    if (gameState.currentPlayer === 'ai') {
                        setTimeout(() => {
                            aiTurn();
                        }, 1000);
                    }
                }, 1000);
            });
            
            optionsContainer.appendChild(btn);
            
            showEventModal();
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–±—ã—Ç–∏—è
        function showEventModal() {
            if (gameState.currentPlayer === 'ai') {
                // –î–ª—è –ò–ò –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    hideEventModal();
                    
                    // –ò–ò –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
                    if (document.getElementById('eventTitle').textContent === '–ë–∏—Ç–≤–∞ —Ä–∞–∑—É–º–∞') {
                        handleRiddleAnswer(Math.random() > 0.3);
                    } else if (document.getElementById('eventTitle').textContent === '–î—Ä–µ–≤–Ω–∏–π –∫–æ–¥') {
                        handlePuzzleAnswer(Math.random() > 0.4);
                    } else if (document.getElementById('eventTitle').textContent === '–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª') {
                        handleQuestionAnswer(Math.random() > 0.5);
                    } else {
                        // –î–ª—è –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π –ø—Ä–æ—Å—Ç–æ –Ω–∞–∂–∏–º–∞–µ–º –ø–µ—Ä–≤—É—é –∫–Ω–æ–ø–∫—É
                        const btn = document.querySelector('#eventOptions .btn');
                        if (btn) {
                            btn.click();
                        } else {
                            gameState.waitingForEvent = false;
                            endTurn();
                        }
                    }
                }, 2000);
            }
            
            document.getElementById('eventModal').classList.add('active');
        }
        
        // –°–∫—Ä—ã—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–±—ã—Ç–∏—è
        function hideEventModal() {
            document.getElementById('eventModal').classList.remove('active');
        }
        
        // –•–æ–¥ –ò–ò
        function aiTurn() {
            if (gameState.currentPlayer !== 'ai' || gameState.waitingForEvent) return;
            
            addLogEntry('–ê—Ä—Ö–∞–ô–û–ù —Ä–∞–∑–º—ã—à–ª—è–µ—Ç...', 'ai');
            
            setTimeout(() => {
                rollDice();
            }, 1500);
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ö–æ–¥–∞
        function endTurn() {
            gameState.diceRolled = false;
            
            if (gameState.currentPlayer === 'human') {
                gameState.currentPlayer = 'ai';
                updateUI();
                
                setTimeout(() => {
                    aiTurn();
                }, 1000);
            } else {
                gameState.currentPlayer = 'human';
                gameState.turn++;
                updateUI();
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –ø–æ–±–µ–¥—ã
        function checkWinCondition() {
            if (gameState.playerPosition >= TOTAL_CELLS - 1) {
                gameState.playerPosition = TOTAL_CELLS - 1;
                showEndGame(true);
                return true;
            } else if (gameState.aiPosition >= TOTAL_CELLS - 1) {
                gameState.aiPosition = TOTAL_CELLS - 1;
                showEndGame(false);
                return true;
            }
            return false;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∫–æ–Ω—Ü–∞ –∏–≥—Ä—ã
        function showEndGame(isPlayerWinner) {
            const endGameModal = document.getElementById('endGameModal');
            const endGameTitle = document.getElementById('endGameTitle');
            const endGameMessage = document.getElementById('endGameMessage');
            
            if (isPlayerWinner) {
                endGameTitle.textContent = '–ü–æ–±–µ–¥–∞!';
                endGameMessage.textContent = '–¢—ã –æ–≤–ª–∞–¥–µ–ª –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º! –í—Ä–µ–º—è ‚Äî –≤ —Ç–≤–æ–∏—Ö —Ä—É–∫–∞—Ö‚Ä¶';
                addLogEntry(`${gameState.playerName} –¥–æ—Å—Ç–∏–≥ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ –∏ –ø–æ–±–µ–¥–∏–ª!`, 'event');
            } else {
                endGameTitle.textContent = '–ü–æ—Ä–∞–∂–µ–Ω–∏–µ';
                endGameMessage.textContent = '–ê—Ä—Ö–∞–ô–û–ù –æ—Å—Ç–∞–Ω–æ–≤–∏–ª —Ç–µ–±—è. –†—É–∏–Ω—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤–µ—á–Ω–æ –∑–∞–ø–µ—á–∞—Ç–∞–Ω–Ω—ã–º–∏‚Ä¶';
                addLogEntry(`–ê—Ä—Ö–∞–ô–û–ù –¥–æ—Å—Ç–∏–≥ –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∞ –ø–µ—Ä–≤—ã–º!`, 'event');
            }
            
            endGameModal.classList.add('active');
        }
        
        // –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏–≥—Ä–æ–∫–∞
        function useSpecialAbility() {
            if (gameState.specialAbilityUsed || !gameState.diceRolled || gameState.currentPlayer !== 'human') return;
            
            gameState.specialAbilityUsed = true;
            
            // –ü–µ—Ä–µ–±—Ä–∞—Å—ã–≤–∞–µ–º –æ–¥–∏–Ω –∫—É–±–∏–∫
            const diceToReroll = Math.random() > 0.5 ? 'dice1' : 'dice2';
            const diceElement = document.getElementById(diceToReroll);
            
            diceElement.classList.add('shake');
            
            setTimeout(() => {
                const newValue = Math.floor(Math.random() * 6) + 1;
                
                if (diceToReroll === 'dice1') {
                    gameState.dice1Value = newValue;
                } else {
                    gameState.dice2Value = newValue;
                }
                
                setDiceFace(diceElement, newValue);
                diceElement.classList.remove('shake');
                
                addLogEntry(`${gameState.playerName} –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∫—É –∏ –ø–µ—Ä–µ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∫—É–±–∏–∫!`, 'human');
                
                // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–≤–∏–∂–µ–Ω–∏–µ
                const totalSteps = gameState.dice1Value + gameState.dice2Value;
                const newPosition = Math.min(gameState.playerPosition + totalSteps, TOTAL_CELLS - 1);
                
                // –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –∏–∑–º–µ–Ω–∏–ª–∞—Å—å
                if (newPosition !== gameState.playerPosition) {
                    gameState.playerPosition = newPosition;
                    addLogEntry(`${gameState.playerName} –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ ${totalSteps} –∫–ª–µ—Ç–æ–∫`, 'human');
                    updatePlayerPositions();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞ –Ω–æ–≤–æ–π –∫–ª–µ—Ç–∫–µ
                    setTimeout(() => {
                        checkCellEvent();
                    }, 1000);
                } else {
                    updateUI();
                }
                
                checkWinCondition();
            }, 1000);
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –∂—É—Ä–Ω–∞–ª
        function addLogEntry(text, type = 'event') {
            const logElement = document.getElementById('gameLog');
            const entry = document.createElement('div');
            
            entry.className = 'log-entry';
            if (type === 'human') entry.classList.add('log-human');
            else if (type === 'ai') entry.classList.add('log-ai');
            else entry.classList.add('log-event');
            
            entry.textContent = text;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        function restartGame() {
            gameState = {
                playerPosition: 0,
                aiPosition: 0,
                currentPlayer: 'human',
                turn: 1,
                dice1Value: 1,
                dice2Value: 1,
                diceRolled: false,
                specialAbilityUsed: false,
                gameStarted: true,
                playerName: gameState.playerName,
                events: [],
                waitingForEvent: false
            };
            
            document.getElementById('gameLog').innerHTML = '';
            document.getElementById('endGameModal').classList.remove('active');
            document.getElementById('eventModal').classList.remove('active');
            
            initGame();
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.getElementById('rollDiceBtn').addEventListener('click', rollDice);
        document.getElementById('specialAbilityBtn').addEventListener('click', useSpecialAbility);
        document.getElementById('restartGameBtn').addEventListener('click', restartGame);
        document.getElementById('playAgainBtn').addEventListener('click', restartGame);
        document.getElementById('startGameBtn').addEventListener('click', () => {
            const nameInput = document.getElementById('playerName');
            gameState.playerName = nameInput.value.trim() || '–†–µ–π–¥–µ—Ä';
            gameState.gameStarted = true;
            document.getElementById('introModal').classList.remove('active');
            initGame();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫—É–±–∏–∫–æ–≤
            setDiceFace(document.getElementById('dice1'), 1);
            setDiceFace(document.getElementById('dice2'), 1);
        });
    </script>
</body>
</html>
